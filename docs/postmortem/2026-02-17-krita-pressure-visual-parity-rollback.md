# 2026-02-17 Krita 压感视觉对齐回退复盘

## 结论
本轮「Krita 压感视觉一致性（无轨迹平滑）」专项在当前分支未达到可接受结果，决定回退到提交 `667152f`（`隐藏Tablet速度设置UI并清理相关代码`），仅保留文档资产。

## 触发回退的直接原因
1. 实测笔触尾部持续出现异常形态：细条、菱形、折线钩子（尤其在高速和变速切换时）。
2. strict gate 未稳定收敛，`stroke_width_profile_emd` 与尾部 dab 计数/间距指标反复超阈。
3. 多轮局部修复（pointerup fallback、coalesced/native 对齐、spacing 控制压力）只能改善部分 case，无法稳定解决用户可见问题。

## 过程里确认过的事实
1. `linear_pressure_mix` 语义检查可通过，说明“线性插值本身”不是主故障点。
2. 主要偏差集中在采样/spacing 与尾段终点消费链路，而非单一 pressure 曲线函数。
3. 当前链路存在多源输入耦合（native buffer + pointer coalesced + pointerup grace），在极端速度场景下易产生不连续尾段几何。

## 为什么本次判定失败
1. 用户侧视觉问题仍明显，且可稳定复现。
2. 数值 gate 与视觉结论无法同时达标。
3. 继续在当前增量补丁上叠修，风险高、收益低，会放大实现复杂度并降低可维护性。

## 回退决策
1. 非文档代码回退到 `667152f` 对应版本。
2. 保留本轮计划/研究/评审等文档，作为下一轮重启依据。
3. 本次不再推进当前实现链路上的继续热修。

## 下一轮建议（重启时执行）
1. 以 Krita `paintLine + getNextPointPosition + spacing update` 做一版最小可运行对照实现（不叠历史补丁）。
2. 先锁定单后端（WinTab）+ 单 case（fast_flick）打通，再扩展到全 case。
3. 建立“用户截图症状 ↔ trace 段落”一一映射，避免只看聚合指标。
