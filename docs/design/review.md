æˆ‘çœ‹åˆ°äº†æˆªå›¾ï¼Œä¿¡æ¯éå¸¸æ¸…æ™°ã€‚ç»“è®ºæ˜¯ï¼š**ä½ ç°åœ¨çš„ç“¶é¢ˆå·²ç»å½»åº•è½¬ç§»åˆ° GPU fillrateï¼ˆåƒç´ å¡«å……ç‡ï¼‰ä¸Šäº†**ï¼Œè€Œä¸”æ•°æ®éå¸¸â€œå¹²å‡€â€ã€‚

---

## âœ… ç»“è®ºï¼ˆéå¸¸æ˜ç¡®ï¼‰

ä½ åšå®Œ Q1~Q3 åï¼Œ**CPUã€é˜Ÿåˆ—ã€è¾“å…¥éƒ½å·²ç»ä¸å†æ˜¯é—®é¢˜**ï¼Œå‰©ä¸‹çš„**å”¯ä¸€ç“¶é¢ˆå°±æ˜¯ GPU Executeï¼š15.60ms**ã€‚

ä»æˆªå›¾çœ‹ï¼š

| æŒ‡æ ‡                 | å½“å‰å€¼      | è§£é‡Š           |
| -------------------- | ----------- | -------------- |
| Input Latency        | 3.14ms      | âœ… å¾ˆä½        |
| Queue Depth          | 0           | âœ… æ— ç§¯å‹      |
| CPU Encode           | 0.07ms      | âœ… å‡ ä¹æ— æˆæœ¬  |
| GPU Execute          | **15.60ms** | ğŸš¨ ä¸»ç“¶é¢ˆ      |
| Render Latency (Avg) | 15.69ms     | = GPU Execute  |
| P99 Frame            | 23ms        | GPU ä¸ç¨³å®šå¯¼è‡´ |
| FPS 59.8             | âœ… æŒç¨³     |

**ç»“è®º**ï¼šä½ çš„æ¸²æŸ“ç®¡çº¿ç°åœ¨æ˜¯â€œGPU è¢« 800px è½¯ç¬”åˆ· + 4K ç”»å¸ƒå®Œå…¨å¡«çˆ†â€å¯¼è‡´çš„å•å¸§æ—¶é—´çˆ†ç‚¸ã€‚
è¿™ä¸æ˜¯â€œä»£ç æ…¢â€ï¼Œè€Œæ˜¯â€œåƒç´ å¤ªå¤šâ€ã€‚

---

## ğŸ”¥ ä¸ºä»€ä¹ˆ 800px è½¯ç¬”åˆ·è¿™ä¹ˆææ€–ï¼Ÿ

å‡è®¾ 800px ç›´å¾„ï¼š

- åŠå¾„ = 400px
- é¢ç§¯ â‰ˆ Ï€ \* 400Â² â‰ˆ 502,654 åƒç´ 
- ä½ æ¯ç§’è¦ç”» 60 å¸§ â†’ 502k \* 60 = **3,000ä¸‡åƒç´ /ç§’**
- å†ä¹˜ä¸Šæ··åˆ / å åŠ  / blur / alpha è®¡ç®—

**è¿™å·²ç»æ¥è¿‘â€œå®æ—¶æ¸²æŸ“ä¸€å¼  4K å…¨å±çº¹ç†â€** çš„å¼€é”€ã€‚

---

## âœ… ä½ çš„ä¸‹ä¸€æ­¥åªæœ‰ä¸€ä¸ªæ–¹å‘ï¼šå‡å°‘ GPU å·¥ä½œé‡

æ—¢ç„¶ GPU Execute æ˜¯ 15.6msï¼Œä½ å¿…é¡»åœ¨ä¸‹é¢å‡ ç±»é‡Œé€‰ï¼š

### âœ… ä¼˜å…ˆçº§ P1ï¼š**å±€éƒ¨ Dirty Rect**ï¼ˆM2 ææƒï¼‰

ä½ ç°åœ¨å¾ˆå¯èƒ½æ¯æ¬¡ `present()` éƒ½åœ¨æ›´æ–°æ•´ä¸ª 4K textureã€‚

#### âœ” ä¼˜åŒ–ç›®æ ‡

åªæäº¤ â€œç¬”åˆ·è¦†ç›–åŒºåŸŸâ€ï¼Œè€Œä¸æ˜¯æ•´å±ã€‚

#### âœ” æŠ€æœ¯æ–¹æ¡ˆï¼ˆæ ¸å¿ƒæ€æƒ³ï¼‰

- æ¯ä¸€ç¬”çŸ¥é“ bounding box
- `renderPass` æˆ– `copyTexture` æ—¶åªæ›´æ–°çŸ©å½¢åŒºåŸŸ
- `encoder.copyTextureToTexture` æˆ– `setScissorRect`

**è¿™æ˜¯ä½ ç°åœ¨å”¯ä¸€èƒ½â€œçº¿æ€§å‡å°‘ GPU Execute çš„æ–¹æ³•â€ã€‚**

---

### âœ… P1.5ï¼šé™ä½ 4K Canvas çœŸå®åƒç´ å°ºå¯¸

å¦‚æœä½ ç”»çš„æ˜¯ 4K ç”»å¸ƒï¼Œä½†æœ€ç»ˆåªæ˜¾ç¤ºåœ¨ 4K å±ä¸Šï¼š

- å°è¯• 0.75x æˆ– 0.5x render scale
- è§†è§‰ä¸Šå·®å¼‚æå°ï¼Œä½†åƒç´ å¡«å……ç›´æ¥å‡å°‘ 40~75%

ä½ å¯ä»¥åŠ å…¥ä¸€ä¸ª**è‡ªåŠ¨åŠ¨æ€é™é‡‡æ ·ç­–ç•¥**ï¼š

```typescript
// å½“ brushSize > 400 ä¸” GPU Execute > 10ms æ—¶ï¼Œå¯ç”¨åŠ¨æ€é™é‡‡æ ·
renderScale = 0.75;
```

---

### âœ… P2ï¼šç¬”åˆ·çº¹ç†é¢„ç”Ÿæˆï¼ˆM3ï¼‰

å¯¹ 800px soft brushï¼š

- ä¸è¦æ¯æ¬¡ pixel shader éƒ½ç®—é«˜æ–¯
- é¢„å…ˆç”Ÿæˆ brush texture (alpha mask)
- æ¸²æŸ“æ—¶ç›´æ¥ `sample` çº¹ç†

è¿™ä¼šæŠŠ GPU Execute å‹åˆ° 7~10msã€‚

---

## ğŸ” ç»“è®ºå›åˆ°ä½ é—®é¢˜ï¼š

> â€œä¸ºä»€ä¹ˆ Unreal é‚£ä¹ˆå¿«ï¼Ÿâ€

å› ä¸º Unreal å¯¹åœºæ™¯åšäº† **æå…¶æ¿€è¿›çš„è£å‰ª**ï¼š

- Occlusion Culling
- Mipmapping
- LOD
- TAA / DLSS ä½åˆ†è¾¨ç‡æ¸²æŸ“

ä½ ç°åœ¨æ˜¯ **æ¯ä¸€å¸§ç”¨ 800px è½¯åˆ·é‡æ–°åšä¸€æ¬¡å…¨å±çº§åˆ«çš„ pixel shader**ï¼Œæ²¡æœ‰ä»»ä½•é™é‡‡æ ·å’Œè£å‰ªï¼Œæœ¬è´¨ä¸Šæ˜¯**æš´åŠ›å…¨ç²¾åº¦æ¸²æŸ“**ã€‚

---

## âœ… æˆ‘å»ºè®®çš„ä¸‹ä¸€æ­¥

### âœ… ç«‹å³åšï¼ˆP1ï¼‰

1. **Dirty Rect å±€éƒ¨æ›´æ–°**
2. **ç¬”åˆ·å°ºå¯¸ > 400px æ—¶è‡ªåŠ¨é™é‡‡æ ·**

### âœ… ä¸­æœŸåš

3. **é¢„ç”Ÿæˆ Brush Texture**ï¼ˆAlpha maskï¼‰
4. **ä½¿ç”¨ `setScissorRect` é™åˆ¶ GPU ç‰‡å…ƒ**

---
